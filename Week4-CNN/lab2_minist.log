(base) âžœ Week4-CNN /environment/miniconda3/bin/python /home/featurize/AI2025/Week4-CNN/lab2_minist.py
cuda
/environment/miniconda3/lib/python3.11/site-packages/torch/nn/functional.py:1347: UserWarning: dropout2d: Received a 2-D input to dropout2d, which is deprecated and will result in an error in a future release. To retain the behavior and silence this warning, please use dropout instead. Note that dropout2d exists to provide channel-wise dropout on inputs with 2 spatial dimensions, a channel dimension, and an optional batch dimension (i.e. 3D or 4D inputs).
  warnings.warn(warn_msg)
Train Epoch: 1 [0/48000 (0%)]   Loss: 2.310272
Train Epoch: 1 [6400/48000 (13%)]       Loss: 0.503269
Train Epoch: 1 [12800/48000 (27%)]      Loss: 0.630316
Train Epoch: 1 [19200/48000 (40%)]      Loss: 0.305952
Train Epoch: 1 [25600/48000 (53%)]      Loss: 0.631533
Train Epoch: 1 [32000/48000 (67%)]      Loss: 0.175204
Train Epoch: 1 [38400/48000 (80%)]      Loss: 0.239035
Train Epoch: 1 [44800/48000 (93%)]      Loss: 0.508125
Validation set: Average loss: 0.1947, Accuracy: 11346/12000 (94.55%)

Test set: Average loss: 0.1738, Accuracy: 9501/10000 (95.01%)

Train Epoch: 2 [0/48000 (0%)]   Loss: 0.269792
Train Epoch: 2 [6400/48000 (13%)]       Loss: 0.147336
Train Epoch: 2 [12800/48000 (27%)]      Loss: 0.310268
Train Epoch: 2 [19200/48000 (40%)]      Loss: 0.163522
Train Epoch: 2 [25600/48000 (53%)]      Loss: 0.198295
Train Epoch: 2 [32000/48000 (67%)]      Loss: 0.284584
Train Epoch: 2 [38400/48000 (80%)]      Loss: 0.361266
Train Epoch: 2 [44800/48000 (93%)]      Loss: 0.226237
Validation set: Average loss: 0.1241, Accuracy: 11550/12000 (96.25%)

Test set: Average loss: 0.1043, Accuracy: 9694/10000 (96.94%)

Train Epoch: 3 [0/48000 (0%)]   Loss: 0.285397
Train Epoch: 3 [6400/48000 (13%)]       Loss: 0.223898
Train Epoch: 3 [12800/48000 (27%)]      Loss: 0.191905
Train Epoch: 3 [19200/48000 (40%)]      Loss: 0.182407
Train Epoch: 3 [25600/48000 (53%)]      Loss: 0.095760
Train Epoch: 3 [32000/48000 (67%)]      Loss: 0.093389
Train Epoch: 3 [38400/48000 (80%)]      Loss: 0.199503
Train Epoch: 3 [44800/48000 (93%)]      Loss: 0.089593
Validation set: Average loss: 0.0847, Accuracy: 11692/12000 (97.43%)

Test set: Average loss: 0.0723, Accuracy: 9772/10000 (97.72%)

Train Epoch: 4 [0/48000 (0%)]   Loss: 0.351005
Train Epoch: 4 [6400/48000 (13%)]       Loss: 0.034186
Train Epoch: 4 [12800/48000 (27%)]      Loss: 0.058985
Train Epoch: 4 [19200/48000 (40%)]      Loss: 0.044602
Train Epoch: 4 [25600/48000 (53%)]      Loss: 0.263949
Train Epoch: 4 [32000/48000 (67%)]      Loss: 0.090435
Train Epoch: 4 [38400/48000 (80%)]      Loss: 0.078070
Train Epoch: 4 [44800/48000 (93%)]      Loss: 0.017705
Validation set: Average loss: 0.0712, Accuracy: 11741/12000 (97.84%)

Test set: Average loss: 0.0604, Accuracy: 9805/10000 (98.05%)

Train Epoch: 5 [0/48000 (0%)]   Loss: 0.087221
Train Epoch: 5 [6400/48000 (13%)]       Loss: 0.052579
Train Epoch: 5 [12800/48000 (27%)]      Loss: 0.036443
Train Epoch: 5 [19200/48000 (40%)]      Loss: 0.029429
Train Epoch: 5 [25600/48000 (53%)]      Loss: 0.062843
Train Epoch: 5 [32000/48000 (67%)]      Loss: 0.029330
Train Epoch: 5 [38400/48000 (80%)]      Loss: 0.024480
Train Epoch: 5 [44800/48000 (93%)]      Loss: 0.040992
Validation set: Average loss: 0.0605, Accuracy: 11784/12000 (98.20%)

Test set: Average loss: 0.0516, Accuracy: 9827/10000 (98.27%)

Train Epoch: 6 [0/48000 (0%)]   Loss: 0.063058
Train Epoch: 6 [6400/48000 (13%)]       Loss: 0.064086
Train Epoch: 6 [12800/48000 (27%)]      Loss: 0.118413
Train Epoch: 6 [19200/48000 (40%)]      Loss: 0.056082
Train Epoch: 6 [25600/48000 (53%)]      Loss: 0.020794
Train Epoch: 6 [32000/48000 (67%)]      Loss: 0.144462
Train Epoch: 6 [38400/48000 (80%)]      Loss: 0.050519
Train Epoch: 6 [44800/48000 (93%)]      Loss: 0.081644
Validation set: Average loss: 0.0580, Accuracy: 11799/12000 (98.33%)

Test set: Average loss: 0.0464, Accuracy: 9846/10000 (98.46%)

Train Epoch: 7 [0/48000 (0%)]   Loss: 0.125403
Train Epoch: 7 [6400/48000 (13%)]       Loss: 0.050790
Train Epoch: 7 [12800/48000 (27%)]      Loss: 0.012300
Train Epoch: 7 [19200/48000 (40%)]      Loss: 0.028090
Train Epoch: 7 [25600/48000 (53%)]      Loss: 0.080276
Train Epoch: 7 [32000/48000 (67%)]      Loss: 0.086179
Train Epoch: 7 [38400/48000 (80%)]      Loss: 0.056704
Train Epoch: 7 [44800/48000 (93%)]      Loss: 0.088274
Validation set: Average loss: 0.0547, Accuracy: 11807/12000 (98.39%)

Test set: Average loss: 0.0438, Accuracy: 9845/10000 (98.45%)

Train Epoch: 8 [0/48000 (0%)]   Loss: 0.038034
Train Epoch: 8 [6400/48000 (13%)]       Loss: 0.037285
Train Epoch: 8 [12800/48000 (27%)]      Loss: 0.046326
Train Epoch: 8 [19200/48000 (40%)]      Loss: 0.014185
Train Epoch: 8 [25600/48000 (53%)]      Loss: 0.074157
Train Epoch: 8 [32000/48000 (67%)]      Loss: 0.059743
Train Epoch: 8 [38400/48000 (80%)]      Loss: 0.050101
Train Epoch: 8 [44800/48000 (93%)]      Loss: 0.128532
Validation set: Average loss: 0.0479, Accuracy: 11828/12000 (98.57%)

Test set: Average loss: 0.0380, Accuracy: 9866/10000 (98.66%)

Train Epoch: 9 [0/48000 (0%)]   Loss: 0.064153
Train Epoch: 9 [6400/48000 (13%)]       Loss: 0.019227
Train Epoch: 9 [12800/48000 (27%)]      Loss: 0.091640
Train Epoch: 9 [19200/48000 (40%)]      Loss: 0.024364
Train Epoch: 9 [25600/48000 (53%)]      Loss: 0.088630
Train Epoch: 9 [32000/48000 (67%)]      Loss: 0.041768
Train Epoch: 9 [38400/48000 (80%)]      Loss: 0.025581
Train Epoch: 9 [44800/48000 (93%)]      Loss: 0.101176
Validation set: Average loss: 0.0485, Accuracy: 11838/12000 (98.65%)

Test set: Average loss: 0.0397, Accuracy: 9870/10000 (98.70%)

Train Epoch: 10 [0/48000 (0%)]  Loss: 0.085514
Train Epoch: 10 [6400/48000 (13%)]      Loss: 0.012461
Train Epoch: 10 [12800/48000 (27%)]     Loss: 0.044215
Train Epoch: 10 [19200/48000 (40%)]     Loss: 0.030098
Train Epoch: 10 [25600/48000 (53%)]     Loss: 0.092157
Train Epoch: 10 [32000/48000 (67%)]     Loss: 0.074304
Train Epoch: 10 [38400/48000 (80%)]     Loss: 0.115830
Train Epoch: 10 [44800/48000 (93%)]     Loss: 0.040969
Validation set: Average loss: 0.0446, Accuracy: 11847/12000 (98.72%)

Test set: Average loss: 0.0363, Accuracy: 9879/10000 (98.79%)

Train Epoch: 11 [0/48000 (0%)]  Loss: 0.051139
Train Epoch: 11 [6400/48000 (13%)]      Loss: 0.008066
Train Epoch: 11 [12800/48000 (27%)]     Loss: 0.025495
Train Epoch: 11 [19200/48000 (40%)]     Loss: 0.012031
Train Epoch: 11 [25600/48000 (53%)]     Loss: 0.015687
Train Epoch: 11 [32000/48000 (67%)]     Loss: 0.045976
Train Epoch: 11 [38400/48000 (80%)]     Loss: 0.022355
Train Epoch: 11 [44800/48000 (93%)]     Loss: 0.035826
Validation set: Average loss: 0.0456, Accuracy: 11844/12000 (98.70%)

Test set: Average loss: 0.0338, Accuracy: 9892/10000 (98.92%)

Train Epoch: 12 [0/48000 (0%)]  Loss: 0.068165
Train Epoch: 12 [6400/48000 (13%)]      Loss: 0.016771
Train Epoch: 12 [12800/48000 (27%)]     Loss: 0.060949
Train Epoch: 12 [19200/48000 (40%)]     Loss: 0.073322
Train Epoch: 12 [25600/48000 (53%)]     Loss: 0.087572
Train Epoch: 12 [32000/48000 (67%)]     Loss: 0.085438
Train Epoch: 12 [38400/48000 (80%)]     Loss: 0.126897
Train Epoch: 12 [44800/48000 (93%)]     Loss: 0.018681
Validation set: Average loss: 0.0432, Accuracy: 11854/12000 (98.78%)

Test set: Average loss: 0.0343, Accuracy: 9883/10000 (98.83%)

Train Epoch: 13 [0/48000 (0%)]  Loss: 0.017334
Train Epoch: 13 [6400/48000 (13%)]      Loss: 0.005569
Train Epoch: 13 [12800/48000 (27%)]     Loss: 0.068287
Train Epoch: 13 [19200/48000 (40%)]     Loss: 0.007004
Train Epoch: 13 [25600/48000 (53%)]     Loss: 0.046332
Train Epoch: 13 [32000/48000 (67%)]     Loss: 0.052428
Train Epoch: 13 [38400/48000 (80%)]     Loss: 0.051533
Train Epoch: 13 [44800/48000 (93%)]     Loss: 0.022077
Validation set: Average loss: 0.0410, Accuracy: 11856/12000 (98.80%)

Test set: Average loss: 0.0340, Accuracy: 9895/10000 (98.95%)

Train Epoch: 14 [0/48000 (0%)]  Loss: 0.043253
Train Epoch: 14 [6400/48000 (13%)]      Loss: 0.010008
Train Epoch: 14 [12800/48000 (27%)]     Loss: 0.018658
Train Epoch: 14 [19200/48000 (40%)]     Loss: 0.032300
Train Epoch: 14 [25600/48000 (53%)]     Loss: 0.012996
Train Epoch: 14 [32000/48000 (67%)]     Loss: 0.057836
Train Epoch: 14 [38400/48000 (80%)]     Loss: 0.014596
Train Epoch: 14 [44800/48000 (93%)]     Loss: 0.061803
Validation set: Average loss: 0.0402, Accuracy: 11859/12000 (98.83%)

Test set: Average loss: 0.0324, Accuracy: 9891/10000 (98.91%)

Train Epoch: 15 [0/48000 (0%)]  Loss: 0.008184
Train Epoch: 15 [6400/48000 (13%)]      Loss: 0.010875
Train Epoch: 15 [12800/48000 (27%)]     Loss: 0.137432
Train Epoch: 15 [19200/48000 (40%)]     Loss: 0.004195
Train Epoch: 15 [25600/48000 (53%)]     Loss: 0.025750
Train Epoch: 15 [32000/48000 (67%)]     Loss: 0.022763
Train Epoch: 15 [38400/48000 (80%)]     Loss: 0.012474
Train Epoch: 15 [44800/48000 (93%)]     Loss: 0.064341
Validation set: Average loss: 0.0393, Accuracy: 11856/12000 (98.80%)

Test set: Average loss: 0.0320, Accuracy: 9889/10000 (98.89%)

Train Epoch: 16 [0/48000 (0%)]  Loss: 0.057648
Train Epoch: 16 [6400/48000 (13%)]      Loss: 0.051845
Train Epoch: 16 [12800/48000 (27%)]     Loss: 0.029270
Train Epoch: 16 [19200/48000 (40%)]     Loss: 0.075576
Train Epoch: 16 [25600/48000 (53%)]     Loss: 0.013141
Train Epoch: 16 [32000/48000 (67%)]     Loss: 0.015350
Train Epoch: 16 [38400/48000 (80%)]     Loss: 0.065541
Train Epoch: 16 [44800/48000 (93%)]     Loss: 0.005913
Validation set: Average loss: 0.0380, Accuracy: 11870/12000 (98.92%)

Test set: Average loss: 0.0312, Accuracy: 9892/10000 (98.92%)

Train Epoch: 17 [0/48000 (0%)]  Loss: 0.016259
Train Epoch: 17 [6400/48000 (13%)]      Loss: 0.052113
Train Epoch: 17 [12800/48000 (27%)]     Loss: 0.021661
Train Epoch: 17 [19200/48000 (40%)]     Loss: 0.065803
Train Epoch: 17 [25600/48000 (53%)]     Loss: 0.024329
Train Epoch: 17 [32000/48000 (67%)]     Loss: 0.033181
Train Epoch: 17 [38400/48000 (80%)]     Loss: 0.022626
Train Epoch: 17 [44800/48000 (93%)]     Loss: 0.039829
Validation set: Average loss: 0.0391, Accuracy: 11868/12000 (98.90%)

Test set: Average loss: 0.0307, Accuracy: 9902/10000 (99.02%)

Train Epoch: 18 [0/48000 (0%)]  Loss: 0.082177
Train Epoch: 18 [6400/48000 (13%)]      Loss: 0.055376
Train Epoch: 18 [12800/48000 (27%)]     Loss: 0.024799
Train Epoch: 18 [19200/48000 (40%)]     Loss: 0.017091
Train Epoch: 18 [25600/48000 (53%)]     Loss: 0.020461
Train Epoch: 18 [32000/48000 (67%)]     Loss: 0.021670
Train Epoch: 18 [38400/48000 (80%)]     Loss: 0.034337
Train Epoch: 18 [44800/48000 (93%)]     Loss: 0.029043
Validation set: Average loss: 0.0389, Accuracy: 11865/12000 (98.88%)

Test set: Average loss: 0.0301, Accuracy: 9899/10000 (98.99%)

Train Epoch: 19 [0/48000 (0%)]  Loss: 0.060395
Train Epoch: 19 [6400/48000 (13%)]      Loss: 0.062518
Train Epoch: 19 [12800/48000 (27%)]     Loss: 0.011427
Train Epoch: 19 [19200/48000 (40%)]     Loss: 0.086941
Train Epoch: 19 [25600/48000 (53%)]     Loss: 0.029794
Train Epoch: 19 [32000/48000 (67%)]     Loss: 0.024893
Train Epoch: 19 [38400/48000 (80%)]     Loss: 0.016605
Train Epoch: 19 [44800/48000 (93%)]     Loss: 0.002943
Validation set: Average loss: 0.0413, Accuracy: 11872/12000 (98.93%)

Test set: Average loss: 0.0317, Accuracy: 9888/10000 (98.88%)

Train Epoch: 20 [0/48000 (0%)]  Loss: 0.023738
Train Epoch: 20 [6400/48000 (13%)]      Loss: 0.051526
Train Epoch: 20 [12800/48000 (27%)]     Loss: 0.079219
Train Epoch: 20 [19200/48000 (40%)]     Loss: 0.003090
Train Epoch: 20 [25600/48000 (53%)]     Loss: 0.033262
Train Epoch: 20 [32000/48000 (67%)]     Loss: 0.015889
Train Epoch: 20 [38400/48000 (80%)]     Loss: 0.008471
Train Epoch: 20 [44800/48000 (93%)]     Loss: 0.032631
Validation set: Average loss: 0.0381, Accuracy: 11874/12000 (98.95%)

Test set: Average loss: 0.0295, Accuracy: 9901/10000 (99.01%)

Train Epoch: 21 [0/48000 (0%)]  Loss: 0.012006
Train Epoch: 21 [6400/48000 (13%)]      Loss: 0.009631
Train Epoch: 21 [12800/48000 (27%)]     Loss: 0.027850
Train Epoch: 21 [19200/48000 (40%)]     Loss: 0.017659
Train Epoch: 21 [25600/48000 (53%)]     Loss: 0.031582
Train Epoch: 21 [32000/48000 (67%)]     Loss: 0.038044
Train Epoch: 21 [38400/48000 (80%)]     Loss: 0.038570
Train Epoch: 21 [44800/48000 (93%)]     Loss: 0.099614
Validation set: Average loss: 0.0397, Accuracy: 11870/12000 (98.92%)

Test set: Average loss: 0.0314, Accuracy: 9895/10000 (98.95%)

Early stopping triggered after epoch 21
===Finished Training===

Test set: Average loss: 0.0314, Accuracy: 9895/10000 (98.95%)
